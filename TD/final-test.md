## 说明

期末测试由三道布置到不常规平台（鸿蒙模拟器）的常规题目（shellcode、rop以及heap）组成

关于如何运行鸿蒙系统请参见之前的 [example](https://gitee.com/zjuicsr/ssec21spring-stu/wikis/harmony%20example?sort_id=4107529)

**时间**: (6月23日 - 7月8日)

> 注: 期末测试将严查抄袭舞弊现象，请严肃对待

## 01 - HarmShell

**分值**: 35分
**题目说明**: 
本题需要编写shellcode并向服务器端发送，服务器会自动解析执行，如果shellcode正确则可以getshell，否则程序崩溃。

题目环境位于: `ip: 10.15.201.97, port: 10000` （校内网）

**题目要点**: 
- 编写shellcode并对汇编语句进行分析 （15分）
- 成功getshell，获得最后的 flag （20分）

> 注: getshell后请同以前作业一样运行 `/etc/flag.exe` 程序

**hint**: 
注意shell的文件名。

## 02 - HarmROP

**分值**: 35分
**题目说明**: 本题在arm架构下的鸿蒙系统中，考察同学对于ROP的理解与使用，本题的程序中提供了一些gift，妥善使用提供的信息，完成ROP攻击吧！

题目环境位于: `ip: 10.15.201.97, port: 10001` （校内网）

**题目要点**: 
- 基本的ARM架构函数调用处理及相关指令的归纳（15分）
- 对于题目的分析（5分）
- getshell，并获取flag（15分）

> 注: getshell后请同以前作业一样运行 `/etc/flag.exe` 程序

**hint**:
虽然是不同的架构，但是攻击的流程大同小异，使用旧的知识在新的平台上大展拳脚吧。
了解一个架构最好的方式，就是**调试**，可以选择魔改题目提供的平台，也可以自己搭建类似的环境。

## 03 - HarmHeap (BONUS)

**分值**: 30分
**题目说明**: 

堆的攻击与利用在不同的平台上往往具有共同性，HarmHeap这一道测试题目旨在考察大家对于一般堆原语的使用。学生需要逆向二进制代码去找到程序逻辑中的漏洞，并基于此漏洞扩展原语，劫持控制流并getshell。

因为是 bonus 题型，欢迎大家在忙完手上的事情后来挑战

题目环境位于: `ip: 10.15.201.97, port: 10002` （校内网）

**题目要点**:

- 分析出程序中存在的漏洞 （10分）
- 利用程序中存在的漏洞让目标崩溃 （10分）
- 构造攻击原语，劫持控制流并getshell，获得最后的 flag （10分）

> 注: flag 在 `/etc/flag.txt` 下

**hint**:
难点在于学习鸿蒙平台下的堆管理器: musl-libc 1.2.0
可以参考之前别的题目如：https://www.anquanke.com/post/id/202253
以及学习其源代码：https://www.musl-libc.org/

